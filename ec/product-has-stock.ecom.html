
<!-- saved from url=(0120)https://cdn.shopify.com/s/files/1/0657/0013/5154/t/2/assets/product-has-stock.ecom.html?v=113700544752324096111676016481 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><template></template>

<script>

  export default {
    name: "Product Has Stock",
    props: {
        data: {
            type: Object,
            default() {
                return {};
            }
        }
    },
    computed: {
      requestShopifyType() {
          let requires = ["collection", "product"];
          if (this.data.template && requires.includes(this.data.template)) {
              return {
                  shopify_type: this.data.template
              };
          }
          return {};
      },
      javascript() {
            return function () {
                let $el = this.$el;
                if(!$el) return;
                if(!this.isLive && typeof T4SThemeSP != 'undefined' && typeof T4SThemeSP.reinitProductGridItem == 'function') {
                  T4SThemeSP.reinitProductGridItem();
                }
            }
      },
      se_stts() {
        return this.data.settings;
      },
  
      itemList() {

            return this.data?.settings?.items?.length ? this.data?.settings?.items.map((item, index)=> {
                    return `
                    {%- liquid 
                      assign product_handle = '${item.product.value}'
                      assign product = all_products[product_handle]
                      assign pr_url = product.url
                      assign pid = product.id
                      assign isDefault = product.has_only_default_variant
                      assign pr_variants = product.variants
                      assign current_variant = pr_variants.first
                      assign isPreoder = false

                      if product.tags contains 'isPreoder' or current_variant.inventory_policy == 'continue' and current_variant.inventory_management == 'shopify' and current_variant.inventory_quantity <= 0 and isDefault and product.available
                         assign isPreoder = true
                      endif

                      if current_variant.inventory_management == 'shopify'
                         assign cur_qty = current_variant.inventory_quantity | default: 9999
                      else
                         assign cur_qty = 9999
                      endif

                      assign meta_theme = product.metafields.theme
                      assign cus_qty = meta_theme.cus_qty | default:1  
                      assign isExternal = false
                      assign external_title = meta_theme.external_title 
                      assign external_link = meta_theme.external_link
                      if external_title != blank and external_link != blank 
                         assign isExternal = true 
                      endif
                      assign isGrouped = false 
                      if  meta_theme.grouped != blank
                         assign isGrouped = true
                      endif

                      assign custom_badge = meta_theme.custom_badge
                      if custom_badge != blank
                         assign arr_badge = custom_badge | replace: '  ', '' | replace: ' ;', ';' | replace: '; ', ';' | split: ';' | join: 'nt-t4s' | escape | split: 'nt-t4s'
                         assign arr_badge_handle = arr_badge | join: 'nt-t4s' | handle | split: 'nt-t4s'
                      else
                         assign badge_tags = product.tags | where: "badge_"
                         if badge_tags.size > 0
                            assign arr_badge_tags   = badge_tags | join: 'nt-t4s' | remove: 'badge_' | escape
                            assign arr_badge        = arr_badge_tags | split: 'nt-t4s'
                            assign arr_badge_handle = arr_badge_tags | handle | split: 'nt-t4s'
                         endif
                      endif

                      assign countdown = time_meta | default: meta_theme.countdown | date: '%Y/%m/%d %H:%M:%S'
                      if use_countdown and countdown != blank
                        assign use_pr_countdown = true
                      endif
                      assign image = product.featured_media | default: placeholder_img

                      assign color_count = 0
                      assign size_count = 0

                      if isDefault == false and enable_pr_color or enable_pr_size
                         assign pr_options = product.options_with_values
                         
                         assign img_variants = pr_variants | where: "featured_image"
                         assign available_variants = product.variants | where: "available"
                         for option in pr_options
                            assign name = option.name | downcase

                            if enable_pr_color and get_color contains name and color_count == 0

                              assign pr_option_color = 'option' | append: forloop.index
                              assign color_variants_avai = available_variants | map: pr_option_color | uniq
                              assign featured_imgs = img_variants | map: 'featured_image'
                              if show_cl_type == '1'
                                 assign color_variants = option.values
                              else
                                 assign color_variants = color_variants_avai
                              endif
                              assign color_count = color_variants.size

                            elsif enable_pr_size and get_size contains name and size_count == 0

                              assign pr_option_size = 'option' | append: forloop.index 
                              assign size_variants_avai = available_variants | map: pr_option_size | uniq
                              if show_size_type == '1'
                                assign size_variants = option.values
                              else
                                assign size_variants = size_variants_avai
                              endif
                              assign size_count = size_variants.size

                            endif

                         endfor
                      endif
                      assign size_on_image = false
                      if size_count > 0 and list_size_pos == '1'
                        assign size_on_image = true
                      endif
                      assign color_on_image = false
                      if color_count > 0 and list_color_pos == '1'
                        assign color_on_image = true
                      endif
                      capture countdown_html
                        if use_pr_countdown 
                          render 'product-countdown',countdown: countdown 
                        endif
                      endcapture
                      assign sold_t4s1 = ${ item.total } | minus: ${ item.available } | times: 100 | divided_by: ${ item.total } | ceil
                      assign sold_t4s = 100 | minus: sold_t4s1
                      assign total_minus_t4s = ${ item.total } | minus: ${ item.available }
                      assign image = product.featured_media | default: placeholder_img
                       -%}
                    <div class="t4s-product t4s-pr-grid t4s-pr-style1 t4s-pr-discount3 t4s-pr-${ item.product.id } t4s-col-item" data-product-options='{ "id": "{{ pid }}","cusQty":"{{ cus_qty }}","available": {{ product.available }}, "handle": "{{ product.handle }}", "isDefault": {{ isDefault }}, "VariantFirstID": {{ current_variant.id }}, "customBadge": {{ arr_badge | json }}, "customBadgeHandle": {{ arr_badge_handle | json }},"dateStart": {{ product.created_at | date: "%s" }}, "compare_at_price": {{ current_variant.compare_at_price | json }},"price": {{ current_variant.price | json }}, "isPreoder": {{ isPreoder }},"isExternal": {{ isExternal }}{% if isExternal %},"external_title": {{ external_title | json }},"external_link": "{{ external_link | escape }}"{% endif %},"image2": {% if product.media[1] != blank %}{{ product.media[1] | image_url: width: 1 | json }},"alt": {{ product.media[1].alt | escape | json }}{% else %}false{% endif %},"isGrouped": {{ isGrouped }},"maxQuantity": {% if isDefault and isPreoder == false %}{{ cur_qty }}{% else %}9999{% endif %} }'>
                        <div class="t4s-product-wrapper">
                          <div data-cacl-slide class="t4s-product-inner t4s-pr t4s-oh">
                            {%- if image != blank %}{% render 'product-img', image: image, imgatt: imgatt -%}{%- endif -%}
                            <div data-product-badge data-sort="sale,new,soldout,preOrder,custom" class="t4s-product-badge"></div>
                              <div class="t4s-product-btns">
                                <div data-replace-quickview data-tooltip-="top"></div>
                                <div data-replace-atc data-tooltip-="top"></div>
                              </div>
                            <div class="t4s-product-btns2">
                              {%- if isGrowaveWishlist -%} 
                                {%- capture the_snippet_fave_icon %}{% render 'ssw-widget-faveicon' with pid %}{% endcapture -%}
                                {%- unless the_snippet_fave_icon contains 'Liquid error' -%}<div class="t4s-pr-item-btn t4s-pr-wishlist is--growave">{{ the_snippet_fave_icon }}</div>{%- endunless -%}
                              {%- else -%}
                                <div data-replace-wishlist data-tooltip="left"></div>
                              {%- endif -%}
                              <div data-replace-compare data-tooltip="left"></div>
                            </div>
                            <a data-pr-href class="t4s-full-width-link" href="{{ pr_url }}"></a>
                          </div>
                          <div class="t4s-product-info">
                            <div class="t4s-product-info__inner">
                              {%- if product.vendor.size > 0 and show_vendor -%}{% if use_link_vendor %}{% assign pr_vendor_handle = product.vendor | handle %}{% assign collection_vendor = collections[pr_vendor_handle] %}{% endif %}<div class="t4s-product-vendor"><a href="{% if use_link_vendor and collection_vendor.url != blank %}{{ collection_vendor.url }}{% else %}{{ product.vendor | url_for_vendor }}{% endif %}">{{ product.vendor }}</a></div>{%- endif -%}
                              <div class="loop-t4s-pr-stock" style="--stock-cl1: ${this.data.style?.stock_items?.cl_stock_1};--stock-cl2: ${this.data.style?.stock_items?.cl_stock_2};">
                             
                                <div class="status-bar">
                                   <div class="sold-bar" style="width: {{sold_t4s}}%"></div>
                                </div>
                                <div class="t4s-pr-stock-status">
                                  <div class="sold">
                                    <span class="label">${this.data.settings?.txt_sold}</span> <span class="value">${ item.available }</span>
                                  </div>
                                  <div class="available"> <span class="label">${this.data.settings?.txt_avai}</span> <span class="value">{{total_minus_t4s}}</span></div>
                                </div>
                              </div>
                              <h3 class="t4s-product-title"><a data-pr-href href="{{ pr_url }}">${ item.product.name }</a></h3>
                              {%- render 'product-price', product: product, price_varies_style: price_varies_style, type: 'card', isGrouped: isGrouped -%}
                            </div>
                          </div>
                        </div>
                      </div>`
                }).join("")
              : ''
            ;
        },
      liquids() {
        return {
          product_has_stock: {
            code: `
              <!-- sections/featured-sale-collection.liquid -->
              {{ 'section.css' | asset_url | stylesheet_tag }}
              {{ 'collection-products.css' | asset_url | stylesheet_tag }}
              {{ 'collection-products-discount.css' | asset_url | stylesheet_tag }}
              {{ 'slider-settings.css' | asset_url | stylesheet_tag }}
              {{ 'pre_flickityt4s.min.css' | asset_url | stylesheet_tag }}
              {%- liquid
                  assign sid = '${this.data.id}'
                  assign stt_layout = '${this.data.settings?.layout}'
                  assign layout_des = '${this.data.settings?.layout_des}'
              -%}
              {%- liquid
                  if stt_layout == 't4s-se-container'
                  assign html_layout = '<div class="t4s-container">__</div></div>' | split: '__'
                  elsif stt_layout == 't4s-container-wrap'
                    assign html_layout = '<div class="t4s-container">__</div>' | split: '__'
                  else
                    assign html_layout = '__' | split: '__'
                  endif

                  assign layout_des = '${this.se_stts?.layout_des}'
                  assign image_ratio = '${this.se_stts?.image_ratio}'
                  if image_ratio == "ratioadapt"
                    assign imgatt = ''
                  else
                    assign imgatt = 'data-'
                  endif

                  assign show_vendor = ${this.se_stts?.show_vendor}
                  assign use_link_vendor = true
                  assign enable_rating = settings.enable_rating
                  if enable_rating
                    assign rating_pos =  '${this.se_stts?.rating_pos}'
                  endif
                  
                  assign nav_btn = ${this.se_stts?.nav_btn}
                  assign nav_dot = false
                  assign btn_owl = 'default'
                  if btn_owl == "outline"
                    assign arrow_icon = 1
                  else
                    assign arrow_icon = 2
                  endif

                  assign show_img = settings.show_img
                  assign isGrowaveWishlist = false
                  if settings.wishlist_mode == "3" and shop.customer_accounts_enabled
                    assign isGrowaveWishlist = true
                  endif
                  assign placeholder_img = settings.placeholder_img
                  assign enable_pr_size = settings.enable_pr_size
                  assign pr_size_pos = settings.pr_size_pos
                  assign show_size_type = settings.show_size_type
                  assign size_ck = settings.size_ck | append: ',size,sizes,Größe'
                  assign get_size = size_ck | downcase | replace: ' ,', ',' | replace: ', ', ',' | split: ',' | uniq

                  assign enable_pr_color = settings.enable_pr_color
                  assign show_cl_type = settings.show_color_type
                  assign color_ck = settings.color_ck | append: ',color,colors,couleur,colour'
                  assign get_color = color_ck | downcase | replace: ' ,', ',' | replace: ', ', ',' | split: ',' | uniq

                  assign price_varies_style = settings.price_varies_style
                  assign app_review = settings.app_review
                  assign use_countdown = ${this.se_stts?.use_cdt}

                  assign isLoadmore = false
                  if layout_des != "3"
                    if use_pagination == "load-more"
                      assign isLoadmore = true
                      assign typeAjax = 'LmDefault'
                    else
                      assign typeAjax = 'AjaxDefault'
                    endif
                  else
                    if use_pagination == "load-more"
                      assign isLoadmore = true
                      assign typeAjax = 'LmIsotope'
                    else
                      assign typeAjax = 'AjaxIsotope'
                    endif
                  endif

                  if request.page_type != 'collection'
                    assign use_pagination = 'none'
                  endif

                  -%}
              {%- if layout_des == "1" -%}
                <div class="t4s-section-content t4s_box_pr_grid t4s-products t4s-justify-content-center t4s-text-${this.data.settings?.content_align} t4s_{{ image_ratio }} t4s_position_${this.se_stts?.image_position} t4s_${this.se_stts?.image_size}  t4s-row t4s-row-cols-lg-${this.data.settings?.col_dk || '4'} t4s-row-cols-md-${this.data.settings?.col_dk__tablet || '3'} t4s-row-cols-${this.data.settings?.col_dk__mobile || '2'} t4s-gx-lg-${this.data.settings?.space_h_item} t4s-gy-lg-${this.data.settings?.space_v_item} t4s-gx-md-${this.data.settings?.space_h_item__tablet} t4s-gy-md-${this.data.settings?.space_v_item__tablet} t4s-gx-${this.data.settings?.space_h_item__mobile} t4s-gy-${this.data.settings?.space_v_item__mobile}">
              {%- else -%} 
                <div data-t4s-resizeobserver class="t4s-section-content t4s-flickity-slider t4s_box_pr_slider t4s-products t4s-text-${this.data.settings?.content_align} t4s_{{ image_ratio }} t4s_position_${this.se_stts?.image_position} t4s_${this.se_stts?.image_size} {% if ${this.data.settings?.nav_btn} %} t4s-slider-btn__${this.data.settings?.btn_pos}-content t4s-slider-btn-style-${this.data.settings?.btn_owl} t4s-slider-btn-${this.data.settings?.btn_shape} t4s-slider-btn-${this.data.settings?.btn_size} t4s-slider-btn-cl-${this.data.settings?.btn_cl} t4s-slider-btn-vi-${this.data.settings?.btn_vi} t4s-slider-btn-hidden-mobile-${this.data.settings?.btn_hidden_mobile} {% endif %}{% if ${this.data.settings?.nav_dot} %} t4s-dots-style-${this.data.settings?.dot_owl} t4s-dots-cl-${this.data.settings?.dots_cl} t4s-dots-round-${this.data.settings?.dots_round} t4s-dots-hidden-mobile-${this.data.settings?.dots_hidden_mobile} {% endif %} t4s-row t4s-row-cols-lg-${this.data.settings?.col_dk || '4'} t4s-row-cols-md-${this.data.settings?.col_dk__table || '3'} t4s-row-cols-${this.data.settings?.col_dk__mobile || '2'} t4s-gx-lg-${this.data.settings?.space_h_item} t4s-gy-lg-${this.data.settings?.space_v_item} t4s-gx-md-${this.data.settings?.space_h_item__tablet} t4s-gy-md-${this.data.settings?.space_v_item__tablet} t4s-gx-${this.data.settings?.space_h_item__mobile} t4s-gy-${this.data.settings?.space_v_item__mobile} flickityt4s" data-flickityt4s-js='{"setPrevNextButtons": true,"arrowIcon": "{{ arrow_icon }}","imagesLoaded": 0,"adaptiveHeight": 0, "contain": 1, "groupCells": "100%", "dragThreshold" : 5, "cellAlign": "left","wrapAround": ${this.data.settings?.loop },"prevNextButtons": {{ ${this.data.settings?.nav_btn} }},"percentPosition": 1,"pageDots": {{ ${this.data.settings?.nav_dot} }}, "pauseAutoPlayOnHover" : ${this.data.settings?.au_hover} }' style="--space-dots: ${this.data.settings?.dots_space}px;">
              {%- endif -%} 
                  ${this.itemList}
              </div>
            `,
            preview: ''
                      
          }
        }
      },
      settings() {
        const settings = [
          {
            group_title: 'Gerenal',
            params:[
              {
                name: "items",
                label: "Product Items",
                type: "group",
                value: [],
                options: {
                    add_text: "Add item",
                    is_clear_all: false
                },
                params: [
                  {
                      type: "picker",
                      label: "Product",
                      name: "product",
                      options: {
                          type: "product",
                          multiple: false
                      }
                  },
                  {
                    type: 'number',
                    label: 'Total Stock',
                    name: 'total',
                    value: "100",
                    default: 100,
                    options: {
                        slider: true,
                        input: true,
                        min: 0,
                        max: 100
                    }
                  },
                  {
                    type: 'number',
                    label: 'Sold Stock',
                    name: 'available',
                    value: "25",
                    default: 25,
                    options: {
                        slider: true,
                        input: true,
                        min: 0,
                        max: 100
                    }
                  }
                ]
              }

            ]
          },
          {
            name: "content_align",
            type: "popup",
            label: "Product content align",
            options: {
                default: true,
                preview: 'title',
                type: 'dropdown',
                values: {
                  'center': "Center",
                }
            }
          },
          {
            type: 'text',
            label: 'Text available',
            name: 'txt_avai',
            description: '',
            value: 'Available:'
          },
          {
              type: 'text',
              label: 'Text sold',
              name: 'txt_sold',
              description: '',
              value: 'Sold:'
          },
          // {
          //   group_title: 'Design',
          //   params: [
          //       {
          //         label: "Layout",
          //         name: "layout",
          //         type: "popup",
          //         value: 't4s-container-wrap',
          //         options: {
          //             preview: "title",
          //             type: "dropdown",
          //             values: {
          //                 't4s-se-container': "Container",
          //                 't4s-container-wrap': "Wrapped container",
          //                 't4s-container-fluid': "Full width"
          //             },
          //             default: false,
          //         }
          //       }
          //   ]
          // },
          {
            group_title: 'Box options',
            params: [
              {
                label: "Layout design",
                name: "layout_des",
                type: "popup",
                value: '2',
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        '1': "Grid",
                        '2': "Carousel"
                    },
                    default: false,
                }
              },
              {
                type: "number",
                label: "Items per row",
                name: "col_dk",
                value: '4',
                options: {
                    responsive: true,
                    min: 1,
                    max: 6
                }
              },
              {
                label: "Space horizontal items",
                name: "space_h_item",
                type: "popup",
                value: 30,
                options: {
                    responsive: true,
                    preview: "title",
                    type: "dropdown",
                    values: {
                        '0': "0",
                        '2': "2px",
                        '4': "4px",
                        '6': "6px",
                        '8': "8px",
                        '10': "10px",
                        '20': "20px",
                        '30': "30px",
                    },
                    default: false,
                }
              },
              {
                label: "Space vertical items",
                name: "space_v_item",
                type: "popup",
                options: {
                    responsive: true,
                    preview: "title",
                    type: "dropdown",
                    values: {
                        '0': "0",
                        '2': "2px",
                        '4': "4px",
                        '6': "6px",
                        '8': "8px",
                        '10': "10px",
                        '20': "20px",
                        '30': "30px",
                    },
                    default: false,
                }
              },

              {
                type: "toggle",
                name: "loop",
                label: "Enable loop",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.layout_des === "2"
                    }
                }
              },
              {
                name: "au_time",
                type: "number",
                label: 'Autoplay speed in second.',
                description: "Set is '0' to disable autoplay",
                options: {
                    min: 0,
                    max: 1500,
                    visible: {
                        keep_data: true,
                        condition: (data) => {
                          condition: (data) => data.layout_des === "2"
                        }
                    }
                }
              },
              {
                type: "toggle",
                name: "au_hover",
                label: "Pause autoplay on hover",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.layout_des === "2"
                    }
                }
              },
              {
                type: "toggle",
                name: "nav_btn",
                label: "USE PREV NEXT BUTTON",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.layout_des === "2"
                    }
                }
              },
              {
                label: "Prev next position",
                name: "btn_pos",
                type: "popup",
                value: "in",
                options: {
                    responsive: true,
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'in': "In content",
                        'out': "Out content",
                        'between': "Content side center"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                label: "Prev next visible",
                name: "btn_vi",
                type: "popup",
                value: "always",
                options: {
                    responsive: true,
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'always': "Always",
                        'hover': "Only hover"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                label: "Prev next style",
                name: "btn_owl",
                type: "popup",
                value: "default",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'default': "Default",
                        'outline': "Outline",
                        'simple': "Simple"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                label: "Button shape",
                name: "btn_shape",
                type: "popup",
                value: "round",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'none': "Default",
                        'round': "Round",
                        'rotate': "Rotate"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                label: "Prev next color",
                name: "btn_cl",
                type: "popup",
                value: "dark",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'light': "Light",
                        'dark': "Dark",
                        'primary': "Primary",
                        'custom1': "Custom color 1",
                        'custom2': "Custom color 2"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                label: "Prev next size",
                name: "btn_size",
                type: "popup",
                value: "none",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'small': "Small",
                        'medium': "Medium",
                        'large': "Large"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                type: "toggle",
                name: "btn_hidden_mobile",
                label: "Hidden buttons on mobile",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.nav_btn === true
                    }
                }
              },
              {
                type: "toggle",
                name: "nav_dot",
                label: "USE PAGE DOTS",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.layout_des === "2"
                    }
                }
              },
              {
                label: "Dots style",
                name: "dot_owl",
                type: "popup",
                value: "none",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'default': "Default",
                        'outline': "Outline",
                        'elessi': "Elessi",
                        'br-outline': "Bordered outline"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              },
              {
                label: "Dots color",
                name: "dots_cl",
                type: "popup",
                value: "dark",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'light': "Light",
                        'dark': "Dark",
                        'primary': "Primary",
                        'custom1': "Custom color 1",
                        'custom2': "Custom color 2"
                    },
                    default: true,
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              },
              {
                label: "Prev next size",
                name: "btn_size",
                type: "popup",
                value: "small",
                options: {
                    preview: "title",
                    type: "dropdown",
                    values: {
                        'small': "Small",
                        'medium': "Medium",
                        'large': "Large"
                    },
                    default: false,
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              },
              {
                type: "toggle",
                name: "dots_round",
                label: "Enable round dots",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              },
              {
                type: 'number',
                label: 'Space among dots',
                name: 'dots_space',
                description: '',
                options: {
                    units: {
                        'px': {
                            min: 0,
                            max: 100
                        }
                    },
                    slider: true,
                    input: true,
                    min: 0,
                    max: 100,
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              },
              {
                type: "toggle",
                name: "dots_hidden_mobile",
                label: "Hidden dots on mobile",
                value: true,
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    },
                    visible: {
                        condition: (data) => data.nav_dot === true
                    }
                }
              }
            ]
          },
          {
            group_title: 'Image',
            params: [
              {
                  name: "image_ratio",
                  type: "popup",
                  label: "Image ratio",
                  value: 'rationt',
                  options: {
                      default: false,
                      type: 'dropdown',
                      preview: 'title',
                      values: {
                        'ratioadapt': "Adapt to image",
                        'ratio2_1': "2:1",
                        'ratio16_9': "16:9",
                        'ratio8_5': "8:5",
                        'ratio3_2': "3:2",
                        'ratio4_3': "4:3",
                        'rationt': "Ratio ASOS",
                        'ratio1_1': "1:1",
                        'ratio2_3': "2:3",
                        'ratio1_2': "1:2"
                      },
                  }
              },
              {
                  name: "image_size",
                  type: "popup",
                  label: "Image size",
                  value: 'contain',
                  options: {
                      default: false,
                      type: 'dropdown',
                      preview: 'title',
                      values: {
                        'cover': "Full",
                        'contain': "Auto",
                      },
                      visible: {
                          condition: (data) => data.image_ratio != "ratioadapt"
                      }
                  }
              },
              {
                  name: "image_position",
                  type: "popup",
                  label: "Image position",
                  value: '8',
                  description: "The first value is the horizontal position and the second value is the vertical.",
                  options: {
                      default: true,
                      type: 'dropdown',
                      preview: 'title',
                      values: {
                        '1': "Left top",
                        '2': "Left center",
                        '3': "Left bottom",
                        '4': "Right top",
                        '5': "Right center",
                        '6': "Right bottom",
                        '7': "Center top",
                        '8': "Center center",
                        '9': "Center bottom"
                      },
                      visible: {
                          condition: (data) => data.image_ratio != "ratioadapt"
                      }
                  }
              }
              
            ]
          }
        ];

        if (this.data.template === "product") {
            settings[0].params.splice(0, 0, {
                type: "paragraph",
                content: `
                    Show the products related with current product watching.\n
                    ### List conditions \n
                    **1. Match with current product type** \n
                    **2. Match with current product vendor** \n
                    **3. In same collection with current product**\n`
            });
            settings[0].params.splice(1, 0, {
                type: "line"
            });
            settings[0].params.splice(14, 0, {
                type: "toggle",
                name: "show_product_available",
                value: true,
                label: "Show product available only",
                options: {
                    oneline: true,
                    values: {
                        on: {
                            label: "Yes",
                            value: true
                        },
                        off: {
                            label: "No",
                            value: false
                        }
                    }
                }
            });
        }

        return settings;
      },

      assignItems() {
          const checkLimit = `
                  {%- capture limit-%}${
                      this.data.settings?.limit ? this.data.settings.limit : 10
                  }{% endcapture %}
                  {%- if limit == blank -%}
                      {% assign limit = 12 %}
                  {% else %}
                      {% assign limit = limit | plus: 0 %}
                  {%- endif-%}
              `;

          if (this.data?.template === "product") {
              return `
                      {% assign ecom_related_type = '' %}
                      {% assign is_collection = false%}
                      {% assign current_product = product %}
                          {% if current_product %}
                              ${checkLimit}
                              {% if recommendations.performed and recommendations.products_count > 0 %}
                                  {% assign products = recommendations.products ${
                                      this.data.settings?.show_product_available
                                          ? ' | where: "available" '
                                          : ""
                                  } %}
                                  {% assign ecom_related_type = 'ecom-product-shopify-related-recommendations' %}
                              {% endif %}
                              {% if product.type and product.type != blank and products.size < 2 or products == blank %}
                                  {% assign collection_all = collections.all%}
                                  {% paginate collection_all.products by 500 %}
                                  {% assign products = collection_all.products  | where: 'type', product.type  ${
                                      this.data.settings?.show_product_available
                                          ? ' | where: "available" '
                                          : ""
                                  } %}
                                  {% endpaginate %}
                                  {% assign ecom_related_type = 'ecom-product-related-shopify-type' %}
                              {% endif %}
                              {% if product.vendor and product.vendor != blank and products == blank or products.size < 2%}
                                  {% assign collection_all = collections.all%}
                                  {% paginate collection_all.products by 500 %}
                                      {% assign products = collection_all.products | where: 'vendor', product.vendor ${
                                          this.data.settings?.show_product_available
                                              ? ' | where: "available" '
                                              : ""
                                      }  %}
                                  {% endpaginate %}
                                  {% assign ecom_related_type = 'ecom-product-related-shopify-vendor' %}
                              {% endif %}
                              {% if product.collections.size > 0 and   products.size < 2 or products == blank %}
                                  {% for c in product.collections %}
                                      {% if c.handle == 'all' or c.handle == 'frontpage'  or c.products_count < 1 %}{% continue%}{% endif%}
                                      {% assign products = c.products  ${
                                          this.data.settings?.show_product_available
                                              ? ' | where: "available" '
                                              : ""
                                      } %}
                                      {% assign ecom_related_type = 'ecom-product-related-shopify-collection' %}
                                      {% assign is_collection = true%}
                                      {% assign collection = c %}
                                  {% endfor %}
                              {% endif %}
                          {% endif %}
                  `;
          } else if (this.data?.template === "collection") {
              return `
                      ${checkLimit}

                      {%- if collection != blank -%}
                          {%- paginate  collection.products by  limit -%}
                          {% assign products = collection.products  %}
                          {% assign is_collection = true %}

                  `;
          } else {
              let sort_by = this.data.settings?.sort_by ?? "";
              let sort_query = "";
              switch (sort_by) {
                  case "title_asc":
                      sort_query = ' | sort: "title" ';
                      break;
                  case "title_desc":
                      sort_query = ' | sort: "title" | reverse ';
                      break;
                  case "price_asc":
                      sort_query = ' | sort: "price"  ';
                      break;
                  case "price_desc":
                      sort_query = ' | sort: "price" | reverse ';
                      break;
                  case "created_at_asc":
                      sort_query = ' | sort: "created_at"  ';
                      break;
                  case "updated_at_desc":
                      sort_query = ' | sort: "created_at" | reverse ';
                      break;
                  default:
                      break;
              }
              if (
                  this.data.settings?.product_source &&
                  this.data.settings.product_source === "products"
              ) {
                  const products = this.data.settings?.products ?? [];
                  const values = products.map((e) => e.value).join(",");
                  return `
                      ${checkLimit}
                      {%- capture handle_products -%}${values}{% endcapture%}
                      {% assign products = handle_products | strip | split: ',' %}
                      {% if products.size < 1 and EComBuilderMode %}
                          {% assign products = collections.all.products  | map: 'handle' | limit: 5 %}
                      {% endif %}
                  `;
              } else if (
                  this.data.settings?.product_source &&
                  ["type", "vendor"].includes(this.data.settings.product_source)
              ) {
                  let k = "product_" + this.data.settings.product_source;
                  return `
                          ${checkLimit}
                          {%- capture value -%}${this.data.settings[k]?.value}{% endcapture%}
                          {% assign products =  collections.all.products | where: '${this.data.settings.product_source}', value ${sort_query} | limit: limit %}

                          {% if products.size < 1 and EComBuilderMode %}
                              {% assign products = collections.all.products | limit:12 %}
                          {% endif %}
                      `;
              } else if (this.data.settings && this.data.settings?.collection) {
                  return `
                          ${checkLimit}
                          {%- capture handle_collection -%}${
                              this.data.settings.collection.value
                          }{% endcapture%}
                          {% assign collection = collections[handle_collection] %}
                          {%- if handle_collection  and collection.handle != blank  -%}
                              {% assign products = collection.products  ${
                                  this.data.settings?.show_product_available
                                      ? ' | where: "available" '
                                      : ""
                              } ${sort_query}%}
                          {% else %}
                              {% assign products = collections.all.products  ${
                                  this.data.settings?.show_product_available
                                      ? ' | where: "available" '
                                      : ""
                              } ${sort_query}%}
                              {% assign collection = collections.all%}
                          {%- endif -%}
                          {% assign is_collection = true %}
                      `;
              }
              return `
                      ${checkLimit}
                      {% assign products = collections.last.products %}
                      {% assign collection = collections.last %}
                      {% assign is_collection = true %}
                  `;
          }
      },
      css() {
        return `
        .t4s-viewall-btn.ecom-t4s-viewall-btn {
            display: flex;
            flex-direction: row;
            align-content: center;
            justify-content: center;
            align-items: center;
        }
        .ecom-t4s-viewall-btn svg{
            width:40px;
            height: 40px;
        }
        .t4s-viewall-btn-after .t4s-viewall-btn-icon{
              order: 1;
          }

        `
      }
    },
    methods: {
      style() {
        let style = [
          {
            group_name: "products_item",
            group_title: "Product items",
            selector: " .t4s-product.t4s-pr-grid",
            params: [
                {
                    type: "tab",
                    name: "tab",
                    value: "normal",
                    options: {
                        tabs: [
                            {
                                name: "normal",
                                title: "Normal"
                            },
                            {
                                name: "hover",
                                title: "Hover"
                            }
                        ]
                    },
                    css: {
                        isCss: false
                    }
                },
                {
                    name: "backgroundColor",
                    label: "Background",
                    type: "color",
                    options: {
                        global: {
                            type: "colors"
                        },
                        oneline: true,
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "normal";
                            }
                        }
                    },
                    css: {
                        properties: {
                            "background-color": ""
                        }
                    }
                },
                {
                    type: "popup",
                    label: "Border",
                    name: "border",
                    options: {
                        type: "border",
                        oneline: true,
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "normal";
                            }
                        }
                    },
                    css: {}
                },
                {
                    type: "popup",
                    label: "Box shadow",
                    name: "boxShadow",
                    options: {
                        oneline: true,
                        type: "box-shadow",
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "normal";
                            }
                        }
                    },
                    css: {}
                },
                {
                    name: "backgroundColorHoverMode",
                    label: "Background",
                    type: "color",
                    options: {
                        global: {
                            type: "colors"
                        },
                        oneline: true,
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "hover";
                            }
                        }
                    },
                    css: {
                        selector: ":hover",
                        properties: {
                            "background-color": ""
                        }
                    }
                },
                {
                    type: "popup",
                    label: "Border",
                    name: "borderHoverMode",
                    options: {
                        type: "border",
                        oneline: true,
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "hover";
                            }
                        }
                    },
                    css: {
                        selector: ":hover"
                    }
                },
                {
                    type: "popup",
                    label: "Box shadow",
                    name: "boxShadowHoverMode",
                    options: {
                        oneline: true,
                        type: "box-shadow",
                        visible: {
                            condition: (data) => {
                                return data["tab"] === "hover";
                            }
                        }
                    },
                    css: {
                        selector: ":hover"
                    }
                },
                {
                    name: "transition",
                    type: "number",
                    label: 'Transition Duration <span class="lowercase">(ms)</span>',
                    options: {
                        min: 0,
                        max: 1500,
                        visible: {
                            keep_data: true,
                            condition: (data) => {
                                return data["tab"] === "hover";
                            }
                        }
                    },
                    css: {
                        properties: {
                            transition: "all %value%ms ease"
                        }
                    }
                },
            ]
          },
          {
              group_alias: "text:hover",
              options: {
                  group_name: "product_title",
                  group_title: "Title",
                  selector: " .t4s-product-title a"
              },
              modify: {
                  remove: {
                      index: 0,
                      length: 1
                  },
                  params: [
                      {
                          position: 1,
                          fields: {
                              alias: "text-align",
                              options: {
                                  label: "Alignment",
                                  css: {
                                    selector: "root .t4s-product-title"
                                  }
                              }
                          }
                      },
                      {
                          position: 10,
                          fields: [
                              {
                                  type: "number",
                                  name: "lines_clamp",
                                  label: "Fixed number of lines",
                                  value: 2,
                                  options: {
                                      min: 1,
                                      max: 5
                                  },
                                  css: {
                                      properties: {
                                          "--ecom-webkit-line-clamp": ""
                                      }
                                  }
                              },
                              {
                                  alias: "spacing",
                                  options: {
                                      name: "spacingNormal",
                                      options: {
                                          visible: (data) => data["tab"] === "normal"
                                      }
                                  }
                              },
                              {
                                  alias: "spacing",
                                  options: {
                                      name: "spacingHover",
                                      options: {
                                          visible: (data) => data["tab"] === "hover"
                                      },
                                      css: {
                                          selector: ":hover"
                                      }
                                  }
                              }
                          ]
                      }
                  ]
              }
          },
          {
              group_alias: "text:spacing",
              options: {
                  group_name: "product_price",
                  group_title: "Price",
                  selector: " .t4s-product-price"
              },
              modify: {
                  remove: {
                      index: 0,
                      length: 1
                  },
                  params: {
                      position: 1,
                      fields: {
                          alias: "text-align",
                          options: {
                              label: "Alignment",
                              css: {
                              }
                          }
                      }
                  }
              }
          },
          {
              group_alias: "text:spacing",
              options: {
                  group_name: "product_price_regular",
                  group_title: "Price regular",
                  selector: " .t4s-product-price del"
              },
              modify: {
                  remove: {
                      index: 0,
                      length: 1
                  },
              }
          },
          {
              group_alias: "text:spacing",
              options: {
                  group_name: "product_price_sale",
                  group_title: "Price Sale",
                  selector: " .t4s-product-price ins"
              },
              modify: {
                  remove: {
                      index: 0,
                      length: 1
                  },
              }
          },
          {
            group_name: "stock_items",
            group_title: "Stock options",
            
            params: [
                {
                    name: "cl_stock_1",
                    label: "Stock primary color",
                    type: "color",
                    options: {
                        global: {
                            type: "colors"
                        },
                        oneline: true
                    },
                    css: {
                        selector: "root .loop-t4s-pr-stock .status-bar .sold-bar",
                        properties: {
                            "background-color": ""
                        }
                    }
                },
                {
                    name: "cl_stock_2",
                    label: "Stock secondary color",
                    type: "color",
                    options: {
                      
                        global: {
                            type: "colors"
                        },
                        oneline: true
                    },
                    css: {
                        selector: "root .loop-t4s-pr-stock .sold .value",
                        properties: {
                            "color": ""
                        }
                    }
                }
            ]
          },
          {
            group_alias: "button",
            options: {
                group_title: "Add to cart button",
                group_name: "add_to_cart_button",
                selector: " .t4s-pr-item-btn.t4s-pr-addtocart"
            },
          },
          {
            group_alias: "button",
            options: {
                group_title: "Quick view button",
                group_name: "quick_view_button",
                selector: " .t4s-pr-item-btn.t4s-pr-quickview"
            },
          }
        ];

        return style;
      }
    }
  }
</script></head><body cz-shortcut-listen="true"></body></html>